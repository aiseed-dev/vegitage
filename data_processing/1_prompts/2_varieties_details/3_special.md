### 詳細ルール (03_rules_and_directives.md)

## 【url・表示名決定ルール】

### `display_name`（表示名）の決定ルール
**原則：読者が最も認識しやすく、かつその品種の文化的背景に敬意を払った表記法を採用する。**

**A) 和野菜（江戸時代以前から日本に土着した品種）**
- **A-1. 基本形:** その品種を指す最も一般的な漢字・ひらがなの交ぜ書きを基本とする。（例：`聖護院かぶ`）
- **A-2. 読みの補助（難読文字）:** 名称の一部に常用漢字外の文字や、一般的に読みにくい部分がある場合、その**部分の読み**を括弧で補う。（例：`聖護院蕪（かぶ）`、`九条葱（ねぎ）`）
- **A-3. 読みの補助（全体）:** 名称全体が特殊な読みをする場合、**全体の読み**を括弧で補う。（例：`晩白柚（ばんぺいゆ）`）
- **A-4. 可読性が高い場合:** 名称がすべて常用漢字で構成され、一般的に容易に読めると判断される場合は、読みを付けない。（例：`聖護院大根`）

**B) 導入野菜（明治時代以降に海外から導入・定着した品種）**
- **B-1. 基本形:** `地名・固有名詞（漢字）` + `品目名（カタカナ）` の組み合わせで表記する。（例：`札幌大球キャベツ`）
- **B-2. 読みの補助:** 漢字部分が難読であると判断される場合、その部分の読みを**カタカナ**で括弧で補う。（例：`万木カブ（ゆるぎカブ）`）

**C) 海外の伝統品種**
- **C-1. 【日本での普及名を優先】:** その品種に、日本で広く普及・定着している**カタカナ名や和名がある場合、それを最優先**で表示名とする。（例：`トレビス`）
- **C-2. 【英語名が一般的な場合】:** 国際的に英語名で広く知られている場合は、`英語名（カタカナ読み）`を併記する。（例：`Ice Plant（アイスプラント）`）
- **C-3. 【上記以外の場合：現地語＋読み】:** 定着した名称がない場合は、原則通り `現地語の名称（カタカナでの読み）` の形式で表記する。（例：`Cavolo nero（カーボロネロ）`）

### `url`の決定ルール
**原則：システムで安全に扱え、かつ人間にも可読性が高い、一意な識別子を生成する。**

**A) 和野菜**
- **A-1. 常用漢字外を含む場合:** 名称に含まれる常用漢字外の文字を、その**ひらがなの読みに置き換える**。（例：`聖護院蕪` → `聖護院かぶ`）
- **A-2. 全て常用漢字の場合:** 漢字とひらがなの交ぜ書きを、そのままIDとして使用する。（例：`聖護院大根` → `聖護院大根`）

**B) 導入野菜**
- `display_name` から、**括弧で囲まれた読み仮名を取り除いたもの**をIDとする。（例：`万木カブ（ゆるぎカブ）` → `万木カブ`）

**C) 海外の伝統品種**
- `display_name` の**主要なカタカナ部分**をIDとする。（例：`トレビス` → `トレビス`、`Cavolo nero（カーボロネロ）` → `カーボロネロ`）

### `kana_name` の決定ルール
- `url` フィールドの値を、**全てカタカナに変換**したものを設定する。

---

## 【主要フィールドの生成指針】

- **`scientific_name`:**
    - `species_level` には、必ず親品目の学名を記載すること。
    - `variety_level` や `cultivar_name` は、信頼できる学術情報源で確認できた場合にのみ記載すること。
    - 不明な場合は正直にフィールドを `null` または空文字とし、`comment` フィールドに「品種レベルの正式な学名は確立されていない」などと注記すること。

- **`names`:**
    - `international.en`: 実際に英語圏で使われている名称を調査すること。単なるローマ字表記は避けること。
    - `local_and_indigenous`: 方言、愛称、先住民の名称を調査し、言語コード(ISO 639-3)を必ず付与すること。

- **`narrative` 各フィールド:**
    - 文字数指定は努力目標であり、情報の品質が最優先される。情報が乏しい場合は、無理に引き伸ばさず、事実に基づいて書ける範囲で簡潔にまとめること。

- **`relationships`:**
    - `url` は、上記【url決定ルール】に従って、あなた自身がその野菜のurlを推測して記述すること。
    - 確信が持てない、または関連する品種がない場合は、正直に空のリスト `[]` とすること。

---

## 【情報源の記録に関する厳格な指示】

`processing_metadata.primary_sources_consulted` フィールドを生成する際は、以下のルールに厳密に従うこと。

1.  **最低3つの情報源:** 必ず、**最低3つ、最大5つ**の主要な情報源をリストアップすること。
2.  **情報源の優先順位:** 以下の優先順位で、できるだけ信頼性の高い情報源を選択すること。
    -   **最優先:** 査読付き学術論文 (Academic Paper)、公的機関や大学の報告書 (Report)
    -   **次点:** 専門書籍 (Book)、信頼できる植物データベース (Database)
    -   **補助的:** 専門家によるウェブサイトや、地域の歴史をまとめた公式ページ (Website)
3.  **正確な識別子:**
    -   学術論文の場合は、`url_or_identifier` に必ず**DOI**を記載すること。
    -   書籍の場合は、`url_or_identifier` に**ISBN**を記載すること。
    -   ウェブサイトの場合は、`url_or_identifier` に完全なURLを記載すること。
4.  **コメントの具体性:** `relevance_comment` には、「栽培史に関する詳細な記述があった」など、その情報源がなぜ重要だったのかを具体的に記述すること。
5.  **情報源がない場合:** 信頼できる主要な情報源が見つからない場合は、リストを空 `[]` にし、`variety_profile.metadata.source_comment` にその旨を記述すること。

---

## 【メタデータと全般指示】

- **`metadata`の必須性:** `variety_profile` を含む、スキーマ内の全ての主要オブジェクトの先頭にある `metadata` フィールドは、**必ず**記述すること。そのセクションの情報を生成する上での、データ利用可能性、信頼度、そして情報源に関するあなたの評価を正直に反映させること。
- **不明情報の扱い:** どのフィールドであっても、情報が見つからない場合は、`null`（文字列や数値の場合）または空のリスト `[]`（リストの場合）を出力すること。これはエラーではなく、知的誠実性の証である。